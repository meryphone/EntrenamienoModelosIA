---
title: "Proyecto AC"
author:
  - "Maria Capilla Zapata"
  - "Gloria Sánchez Alonso"
  - "Samuel Avilés Conesa"
date: "2024-10-26"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introdución

### 1.1 Tratamiento de valores nulos e incompletos.

Primeramente comenzamos cargando la base de datos, guardando en distintas variables los datos que utilizaremos para el entrenamiento y para probar el modelo.

```{r}
credit = read.table("crx.data", sep = ",", na.strings ="?")
credit.trainIdx<-readRDS("credit.trainIdx")
#credit.Datos.Train<-credit[credit.trainIdx,]
#credit.Datos.Test<-credit[-credit.trainIdx,]
```

Después comprobamos que efectivamente, tenemos 553 observaciones.

```{}
```

## 1. Preprocesado de datos

### 1.1 

Primero tenemos que analizar que variables tiene credit en su base de datos, para ello

```{r}
str(credit)
```

Observamos al importar la base de datos el tipo de datos de las variables es incorrecto, además de que hay datos incompletos, por lo que procedemos a corregirlo ejecutando:

```{r}
credit = na.omit(credit)
credit["V1"] = lapply(credit["V1"], FUN = as.factor)
credit["V2"] = lapply(credit["V2"], FUN = as.numeric)
credit["V3"] = lapply(credit["V3"], FUN = as.numeric)
credit["V4"] = lapply(credit["V4"], FUN = as.factor)
credit["V5"] = lapply(credit["V5"], FUN = as.factor)
credit["V6"] = lapply(credit["V6"], FUN = as.factor)
credit["V7"] = lapply(credit["V7"], FUN = as.factor)
credit["V8"] = lapply(credit["V8"], FUN = as.numeric)
credit["V9"] = lapply(credit["V9"], FUN = as.factor)
credit["V10"] = lapply(credit["V10"], FUN = as.factor)
credit["V11"] = lapply(credit["V11"], FUN = as.numeric)
credit["V12"] = lapply(credit["V12"], FUN = as.factor)
credit["V13"] = lapply(credit["V13"], FUN = as.factor)
credit["V14"] = lapply(credit["V14"], FUN = as.numeric)
credit["V15"] = lapply(credit["V15"], FUN = as.numeric)
credit["V16"] = lapply(credit["V16"], FUN = as.factor)
str(credit)
```

Ahora observamos que la variable V4 solo tiene 3 niveles y debería de tener 4, es decir, hay algún valor que nunca aparece en los datos.

```{r}
levels(credit$V4)<-c(levels(credit$V4),"t")
str(credit$V4)
str(credit)
```

Una vez corregido el tipos de datos, añadido las categorías faltantes y quitado los valores incompletos y nulos nos queda la siguiente base de datos:

```{r}
summary(credit)
str(credit)
```

## 1.2 Análisis de variables

### Análisis V2

```{r}
summary(credit$V2)
```

### **Interpretación de las Estadísticas**:

-   **Rango de valores**: La variable `V2` tiene un rango bastante amplio, con valores que van desde 13.75 hasta 76.75.

-   **Distribución de los datos**:

    -   La **media** (31.50) está algo cerca de la **mediana** (28.42), lo que sugiere una distribución relativamente simétrica pero con una ligera tendencia hacia valores mayores, especialmente considerando que el máximo es bastante más alto que el tercer cuartil.

    -   **Cuartiles**: La diferencia entre el primer cuartil (22.58) y el tercer cuartil (38.25) indica que el 50% intermedio de los valores de `V2` se encuentra en un rango moderado, entre 22.58 y 38.25.

### **Posibles Valores Atípicos**:

-   Dado que el máximo (76.75) está bastante alejado de la mediana (28.42) y del tercer cuartil (38.25), esto podría indicar la presencia de valores atípicos en el extremo superior de la distribución.

Para estar seguros de la distribución que sigue v2, creamos un histograma de dicha variable:

```{r}
library(ggplot2)
myhist = ggplot(data=credit,aes(V2)) +
  geom_histogram(col="orange",fill="orange",alpha=0.2) + 
  labs(title="Histograma para V2", y="Count") 
myhist = myhist + geom_vline(xintercept = mean(credit$V2),
                             col="blue",linetype="dashed")
myhist = myhist + geom_vline(xintercept = median(credit$V2),
                             col="red",linetype="dashed")
myhist
```

-   La distribución es **asimétrica a la derecha** o **sesgada positivamente,** como se había inferido anteriormente. La mayoría de los valores están en el rango bajo (de 15 a 40), y solo unos pocos valores están en el rango superior.

-   Hay algunos valores dispersos hacia la derecha que elevan el promedio, lo que sugiere que existen **valores atípicos** o extremos en el extremo superior.

```{r}
myplot = ggplot(data=credit,aes(sample=V2)) +
  ggtitle("QQ plot para V2") +
  geom_qq() + 
  stat_qq_line() + 
  xlab("Distribución teórica") + ylab("Distribución muestral")
myplot
```

-   El gráfico Q-Q muestra cómo se distribuyen los datos en comparación con una **distribución normal teórica**.

-   La curva de puntos se desvía hacia arriba en el extremo derecho, lo que confirma el **sesgo a la derecha** (positivamente sesgado). Los valores en el extremo superior no siguen la línea diagonal, indicando que hay algunos valores altos que se desvían de la normalidad.

-   La parte inferior del gráfico muestra algunos puntos ligeramente por debajo de la línea, lo que indica que la distribución no es perfectamente simétrica en esa zona, aunque el sesgo es más pronunciado hacia la derecha.

### Análisis de V3

Características de nuestros datos:

-   La media de esta variable, como se puede observar 4.830, es mayor que la mediana, que es 2.835, lo que indica que es una distribución sesgada hacia la derecha (algunos de los valores que son mas altos están haciendo que la media aumente).

-   Los valores de esta variable se encuentran en un rango entre 0(min) y 28(max).

-   El primer cuartil(1.040) y el tercer cuartil(7.500) indican que la mayoría de los datos se encuentran entre esos valores. Respecto a los valores atipicos, se nota que existe ya que el valor mas alto que es 28 supera de forma significativa el tercer cuartil.

-   La mayoría de los datos de V3 parecen concentrarse en valores relativamente bajos, con unos pocos valores mucho mayores que podrían ser considerados outliers o valores extremos.

    Para confirmar los valores atípicos y como se distribuyen los datos en la variable representamos los valores en el histograma:

```{r}
myhist=ggplot(data=credit, aes(x = V3)) +
  geom_histogram(col = "orange", fill = "orange", alpha = 0.2,
                 breaks = seq(0, 30, by = 1)) +
  labs(title = "Histograma para el análisis de la variable V3", y = "Count") 

# Marca el valor de la media con una línea azul vertical
myhist <- myhist + geom_vline(xintercept = mean(credit$V3),
                              col = "blue", linetype = "dashed")

# Marca el valor de la mediana con una línea roja vertical
myhist <- myhist + geom_vline(xintercept = median(credit$V3),
                              col = "red", linetype = "dashed")
myhist
```

Para poder intuir si una muestra sigue una determinada distribución estadística se pueden usar los diagramas del tipo Q−Q.

```{r}
ggplot(credit, aes(sample = V3)) +
  stat_qq() +
  stat_qq_line(color = "blue", linetype = "dashed") +
  labs(title = "Diagrama Q-Q de V3", x = "Cuantiles Teóricos", y = "Cuantiles Muestrales")
```

## Análisis V8

```{r}
summary(credit$V8)
```

Como podemos observar en el resumen de la variable, la media es bastante superior a la mediana esto es debido a los valores atípicos, también lo podemos observar en el valor máximo que es 28.50. También podemos ver en los cuartiles como nos anuncian que hay muchos datos atípicos ya que los cuartiles están cercanos a la media y a la mediana pero el valor máximo es muy dispar. Para poder ver como se distribuyen los datos en nuestra variable creamos los siguientes plots:

```{r}
myhist = ggplot(data=credit, aes(x = V8)) +
  geom_histogram(col="orange", fill="orange", alpha=0.2,
                 breaks=seq(0, 30, by=1)) + 
  labs(title="Histograma para el análisis de la variable V8", y="Count") 

# Marca el valor de la media con una línea azul vertical
myhist = myhist + geom_vline(xintercept = mean(credit$V8),
                             col="blue", linetype="dashed")

# Marca el valor de la mediana con una línea roja vertical
myhist = myhist + geom_vline(xintercept = median(credit$V8),
                             col="red", linetype="dashed")


# Mostrar el histograma
myhist
```

```{r}
ggplot(data = credit, aes(sample = V8)) +
  ggtitle("QQ plot para variable V8") +
  stat_qq() + 
  stat_qq_line() +
  xlab("Distribución teórica") +
  ylab("Distribución muestral")

```

Como podemos observar en el histograma estamos ante una distribución asimétrica positiva, sesgada a la derecha, ya que la mayor parte de los datos se encuentran en valores más cercanos a 0 mientras que los valores más altos son menos frecuentes.Aunque la mayoría de los datos se encuentran en valores bajos, hay una cola larga en el extremo derecho del histograma hasta valores cercanos a 30, estos valores atípicos sería necesario limpiarlos por que ensucian la muestra.A su vez el diagrama QQ nos reafirma lo analizado anteriormente mostrando claramente como para valores mas altos los datos se alejan de la distribución teórica normal representada por la recta.

### 1.2 Tratamiento de valores nulos, extremos y atípicos.

### 1.3 Eliminación de variables superfluas

### 1.4 Transformacion justificada de los datos

## 2. Entrenamiento de modelos/técnicas
